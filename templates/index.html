<!doctype html>
<html>
  <head>
	<title>Indel Mapper</title>
	<link rel=stylesheet href="{{ url_for('static', filename='style.css') }}">
  </head>

  <body>
	<div class="container">

	  <div class="banner">
		<h1 id=title>Indel Mapper</h1>
	  </div>

	  {% with flashes = get_flashed_messages() %}
      {% if flashes %}
      <div class=flashes>
        <ul>
          {% for f in flashes %}
          <li>{{ f }}</li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}
      {% endwith %}

      {% block body %}
      {% endblock body %}

	  <form method="POST" enctype="multipart/form-data">

		<div>
		  <label for="alignment">Alignment SAM File</label>
		  <input name="alignment" type="file">
		  <p> The alignment SAM file is the output of bowtie2 alignment. <p>
		</div>

		<div>
		  <label for="reference">Reference CSV File</label>
		  <input name="reference" type="file">
		  <p> The reference CSV file should be formatted with name of the reference, reference sequence, n20, and pam.</p>
		  <p> It should not have headers. The pam should be NGG or CCN. </p>
		  <p>Example row: brc2,[reference sequence],[n20 sequence],NGG </p>
		</div>

		<div>
		  <input type="submit" value="Submit">
		</div>
	  </form>

	  <div class="result-container">
		{% for reference_presenter in results %}
		<h2 class="reference-result">{{ reference_presenter.name() }}</h2>
		<p class="reference-sequence">Sequence: {{ reference_presenter.sequence() }}</p>
		<p>N20: {{reference_presenter.n20() }}</p>
		<p>PAM: {{reference_presenter.pam() }}</p>
		{% for tally in reference_presenter.tallies %}
		<div class="read-reference-result">
		  <p>Cutsite Region: {{ tally.cutsite_region_representation }}</p>
		  <p>Count: {{ tally.count() }}</p>
		  {% for sequence in tally.presentations %}
		  <div class="sequence">
		  <p>Ref : {{ sequence.reference_sequence_presentation }}</p>
		  <p>Read: {{ sequence.read_sequence_presentation }}</p>
		  </div>
		  {% endfor %}
		</div>
		{% endfor %}
		{% endfor %}
	  </div>
	</div>

  </body>

</html>
